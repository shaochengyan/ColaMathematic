% 观测数据
Z = (1:100); 
noise = rand(1, 100);  
Z = Z + noise;

% 参数 
X = [0; 0];  % 状态
P = [1, 0; 0, 1];  % 状态协方差矩阵
F = [1, 1; 0, 1];  % 状态转移矩阵
Q = [0.0001, 0; 0, 0.0001];  % 状态转移协方差矩阵
H = [1, 0];  % 观测矩阵
R = 1;  % 观测噪声协方差

figure(1);

for i = 1:100
    X_ = F * X;
    P_ = F * P * F' + Q;
    K = P_ * H' / ( H * P_ * H' + R );
    X = X_ + K * (Z(i) - H*X_);
    P = (eye(2) - K*H) * P_;
    hold on
    plot(X(1), X(2), '.r');   % (p, v)
end

